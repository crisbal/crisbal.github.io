<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Emoji in SQL - SELECT ğŸ—£ FROM ğŸ‘¤ - Cristian Baldi</title><meta name="gridsome:hash" content="54e3d1d78e46c05fb1736bc762343f16bc1ace22"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="description" content="I had a doubt, can you use Emoji in SQL? Turns out you can, and it works very well."><link data-vue-tag="ssr" href="https://cdn.materialdesignicons.com/5.3.45/css/materialdesignicons.min.css" rel="stylesheet"><link data-vue-tag="ssr" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&amp;display=swap" rel="stylesheet"><link rel="preload" href="/assets/css/0.styles.f1deec0a.css" as="style"><link rel="preload" href="/assets/js/app.9671136a.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.e9618719.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.216f84d8.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.ec7cc472.js"><link rel="prefetch" href="/assets/js/page--src--pages--photos-vue.17a53fb2.js"><link rel="prefetch" href="/assets/js/page--src--pages--posts-vue.6e6cfc1c.js"><link rel="prefetch" href="/assets/js/page--src--pages--resume-vue.a03c7ee7.js"><link rel="stylesheet" href="/assets/css/0.styles.f1deec0a.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="View View--Post" data-v-9281d02e><header class="Header View__heaader"><a href="/" class="Header__title active">Cristian Baldi</a><div class="spacer"></div><nav class="Header__nav"><a href="https://github.com/crisbal" target="_blank" class="Header__link">Projects</a><a href="/photos" class="Header__link">Photos</a><a href="/posts" class="Header__link active">Posts</a></nav></header><main class="View__main"><article class="Post" data-v-9281d02e><header data-v-9281d02e><div class="Post__date" data-v-9281d02e>OnÂ <time datetime="2017-06-26" pubdate="pubdate" data-v-9281d02e>26 June 2017</time></div><h2 class="Post__title" data-v-9281d02e><a href="/posts/2017/06/26/emoji-in-sql-select-from/" aria-current="page" class="active--exact active" data-v-9281d02e>Emoji in SQL - SELECT ğŸ—£ FROM ğŸ‘¤</a></h2></header><div class="Post__content" data-v-9281d02e><script src="//twemoji.maxcdn.com/2/twemoji.min.js?2.3.0"></script>
<script>
window.onload = function() {
  twemoji.size = '72x72';
  twemoji.parse(document.body);
}
</script>
<style>
img.emoji {
	margin: 0px !important;
	display: inline !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .05em 0 .1em !important;
	vertical-align: -0.1em !important;
}
.highlight .err {
	color: black !important;
	background-color: transparent !important;
}

</style>
<blockquote>
<p><strong>WARNING</strong> Don't try this at <del>home</del> work: just because you can do it, it does not mean you should do it. Also don't take the post too seriously.</p>
</blockquote>
<p>Yesterday I had a doubt: can you use Emoji in SQL? No, I don't mean storing Emoji in a <code>TEXT</code> column, I mean using Emoji for naming databases, tables, columns. Turns out you can (at least on SQL implementations I tried, <strong>SQLite</strong> and <strong>PostgreSQL 9.6</strong>) and it works very well.</p>
<p>It is not magic, Emoji are Unicode characters and you can use Unicode characters inside SQL names.</p>
<h2 id="create-table-"><a href="#create-table-" aria-hidden="true"><span class="icon icon-link"></span></a>CREATE TABLE ğŸ‘¤</h2>
<p>I decided to re-implement the classic "Public Library" database we all built when learning SQL. Yes, <em>that</em> one database we have practiced on at school, storing users, books, authors and keeping tracks of Books read by users.</p>
<p>First of all let's create the database, since we are working with a library we will call it ğŸ“š.</p>
<pre><code class="language-sql">CREATE DATABASE ğŸ“š;
USE ğŸ“š; -- \c ğŸ“š in PostgreSQL
</code></pre>
<p>Then we begin by creating the users table:</p>
<pre><code class="language-sql">CREATE TABLE ğŸ‘¤(
    ğŸ”‘ INTEGER PRIMARY KEY,
    ğŸ—£ varchar(64), -- name
    ğŸ—“ DATE -- date of registration
);
</code></pre>
<p>As you can see using Emoji solves the classical naming problem you have when programming: waste no more time on "Should I call the table <code>User</code> or <code>Users</code>?", just use ğŸ‘¤.</p>
<p>Let's keep build the database by adding the table for the authors:</p>
<pre><code class="language-sql">CREATE TABLE âœ(
    ğŸ”‘ INTEGER PRIMARY KEY,
    ğŸ—£ varchar(64)
);
</code></pre>
<p>And a table for the books:</p>
<pre><code class="language-sql">CREATE TABLE ğŸ“•(
    ğŸ”‘ INTEGER PRIMARY KEY,
    ğŸ’¬ varchar(64), -- title
    ğŸ”– varchar(64), -- genre/tag
    âœ INTEGER REFERENCES âœ(ğŸ”‘) -- who wrote the book?
);
</code></pre>
<p>Finally let's create a table for storing which books were read by which user.</p>
<p>We will use the instantly recognizable name ğŸ‘¤ğŸ ğŸ“• for this table, which as we all know stands for "User took the Book home": it is that easy.</p>
<pre><code class="language-sql">CREATE TABLE ğŸ‘¤ğŸ ğŸ“•(
    ğŸ‘¤ INTEGER REFERENCES ğŸ‘¤(ğŸ”‘),
    ğŸ“• INTEGER REFERENCES ğŸ“•(ğŸ”‘)
);
</code></pre>
<h2 id="populating-the-database"><a href="#populating-the-database" aria-hidden="true"><span class="icon icon-link"></span></a>Populating the database</h2>
<p>This is the boring bit, just the classic <code>INSERT INTO</code>s.</p>
<pre><code class="language-sql">INSERT INTO ğŸ‘¤ VALUES
    (1, 'Jeff', CURRENT_DATE),
    (2, 'Annie', CURRENT_DATE);

INSERT INTO âœ VALUES
    (1, 'Herman Melville'),
    (2, 'Lewis Carroll');

INSERT INTO ğŸ“• VALUES
    (1, 'Alice in Wonderland', 'ğŸ”®', 2), -- genre is fantasy
    (2, 'Moby Dick', 'ğŸ“–', 1), -- genre is novel
    (3, 'Through the Looking-Glass', 'ğŸ”®', 2); -- genre is fantasy

INSERT INTO ğŸ‘¤ğŸ ğŸ“• VALUES
    (1, 1), -- Jeff took home 'Alice in Wonderland'
    (1, 2), -- Jeff took home 'Moby Dick'
    (2, 2); -- Annie took home 'Moby Dick'
</code></pre>
<h2 id="queries"><a href="#queries" aria-hidden="true"><span class="icon icon-link"></span></a>Queries</h2>
<p>One common task when dealing with this database is finding out which books were read by which users. The query by itself is simple but using Emoji is even simpler: you visualize concepts not names.</p>
<pre><code class="language-sql">-- get the book taken home by each people
SELECT ğŸ‘¤.ğŸ—£ AS ğŸ‘¤, ğŸ“•.ğŸ’¬ AS ğŸ“•
FROM ğŸ‘¤ JOIN ğŸ‘¤ğŸ ğŸ“• ON ğŸ‘¤.ğŸ”‘ = ğŸ‘¤ğŸ ğŸ“•.ğŸ‘¤
    JOIN ğŸ“• ON ğŸ“•.ğŸ”‘ = ğŸ‘¤ğŸ ğŸ“•.ğŸ“•;
</code></pre>
<p>which results in:</p>
<pre><code>   ğŸ‘¤  |         ğŸ“•
-------+---------------------
 Jeff  | Alice in Wonderland
 Jeff  | Moby Dick
 Annie | Moby Dick
</code></pre>
<h2 id="extending-the-concept"><a href="#extending-the-concept" aria-hidden="true"><span class="icon icon-link"></span></a>Extending the concept</h2>
<p>We want to extend our <code>ğŸ“•</code> table to also store how long each book is. The naive solution would be to use an INTEGER field to solve the problem, but sometimes numbers are confusing, in these times Emoji are here to help.</p>
<p>To help us simplify the concept of book length we will use a custom <code>TYPE</code> (n.d.r: custom <code>TYPE</code>s are not available in SQLite).</p>
<pre><code class="language-sql">CREATE TYPE ğŸ“„ AS ENUM ('ğŸ“„', 'ğŸ“„ğŸ“„', 'ğŸ“„ğŸ“„ğŸ“„', 'ğŸ“„ğŸ“„ğŸ“„ğŸ“„');
</code></pre>
<p>The longer the book the more ğŸ“„ it will have.</p>
<p>Let's update the <code>ğŸ“•</code> table.</p>
<pre><code class="language-sql">ALTER TABLE ğŸ“•
    ADD COLUMN ğŸ”¢ğŸ“„ ğŸ“„ DEFAULT 'ğŸ“„';

INSERT INTO ğŸ“• VALUES
    (4, 'Example Book', 'ğŸ”®', 1, 'ğŸ“„ğŸ“„ğŸ“„');
</code></pre>
<p>It is pretty easy to select long books (You may ask "What is the definition of long?", the answer is simple, more than 2 ğŸ“„):</p>
<pre><code class="language-sql">SELECT * FROM ğŸ“• WHERE ğŸ“•.ğŸ”¢ğŸ“„ > 'ğŸ“„ğŸ“„';
</code></pre>
<p>Resulting in:</p>
<pre><code>ğŸ”‘ |      ğŸ’¬       | ğŸ”– | âœ | ğŸ”¢ğŸ“„
---+---------------+----+---+-------
 4 | Example Book  | ğŸ“– | 1 | ğŸ“„ğŸ“„ğŸ“„
</code></pre>
<h2 id="rating"><a href="#rating" aria-hidden="true"><span class="icon icon-link"></span></a>Rating</h2>
<p>We also want the possibility for the users to rate books.</p>
<p>Ideally we would want to implement a rating scale: for example a number from 1 to 10. But we all know that you can't really communicate how you feel about a book with just a number, that's why we need Emoji.</p>
<pre><code class="language-sql">CREATE TYPE â­ AS ENUM ('ğŸ¤¢', 'â˜¹', 'ğŸ˜', 'ğŸ™‚', 'ğŸ˜');

ALTER TABLE ğŸ‘¤ğŸ ğŸ“•
    ADD COLUMN â­ â­;
</code></pre>
<p>We then add some fake data:</p>
<pre><code class="language-sql">INSERT INTO ğŸ‘¤ğŸ ğŸ“• VALUES
    (1, 4, 'ğŸ˜'), -- Jeff took home 'Example Book' and rated it ğŸ˜
    (2, 3, 'ğŸ™‚'), -- Annie took home 'Through the Looking-Glass' and rated it ğŸ™‚
    (2, 4, 'ğŸ˜'), -- Annie took home 'Example Book' and rated it ğŸ˜
    (2, 4, 'ğŸ¤¢'); -- Annie took home 'Example Book' (yes again) and rated it ğŸ¤¢
</code></pre>
<p>And we can finally get some meaningful info.</p>
<pre><code class="language-sql">-- select the ratings for 'Example Book'
SELECT ğŸ‘¤ğŸ ğŸ“•.â­
FROM ğŸ‘¤ğŸ ğŸ“• JOIN ğŸ“• ON ğŸ‘¤ğŸ ğŸ“•.ğŸ“• = ğŸ“•.ğŸ”‘
WHERE ğŸ“•.ğŸ’¬ = 'Example Book';
</code></pre>
<pre><code> â­
---
 ğŸ˜
 ğŸ˜
 ğŸ¤¢
</code></pre>
<p>This next query is useful for the frontend, just display the Emoji instead of some over complicated visualization logic for the rating:</p>
<pre><code class="language-sql">-- select the most common rating for each book
-- MODE() is another function exclusive to PostgreSQL
--- https://wiki.postgresql.org/wiki/Aggregate_Mode
SELECT ğŸ“•.ğŸ’¬, MODE() WITHIN GROUP (ORDER BY ğŸ‘¤ğŸ ğŸ“•.â­) AS MostCommonRating
FROM ğŸ‘¤ğŸ ğŸ“• JOIN ğŸ“• ON ğŸ‘¤ğŸ ğŸ“•.ğŸ“• = ğŸ“•.ğŸ”‘
GROUP BY  ğŸ“•.ğŸ”‘;
</code></pre>
<pre><code>             ğŸ’¬            | mostcommonrating
---------------------------+------------------
 Alice in Wonderland       | NULL
 Moby Dick                 | NULL
 Through the Looking-Glass | ğŸ™‚
 Example Book              | ğŸ˜
</code></pre>
<h2 id="whats-next"><a href="#whats-next" aria-hidden="true"><span class="icon icon-link"></span></a>What's next?</h2>
<p>It would be even cooler if we could write queries in this format, but I don't see this as a possibility without the cooperation from the major SQL DBMS.</p>
<pre><code class="language-sql">ğŸ” *            -- SELECT *
â¡ï¸ ğŸ“•           -- FROM Book
â“ ğŸ“•.ğŸ’¬ = "Moby Dick"  -- WHERE Book.Title = "Moby Dick"
</code></pre>
<p>On a serious note, I had the idea to write a comparator function that given two modified/composite Emoji (such as ğŸ…ğŸ¿ and ğŸ…ğŸ») would return TRUE if the two Emoji belong to the same unmodified Emoji: I did not want to waste much more time on this so I skipped it.</p>
<p>I think it would be pretty trivial to do, since a modified/composite Emoji is just two Unicode characters one after another, so getting the first character from both Emoji and checking equality should be enough.</p>
<p>If someone implements this please let me know.</p>
<h2 id="summing-up"><a href="#summing-up" aria-hidden="true"><span class="icon icon-link"></span></a>Summing up</h2>
<p>Please don't take this post seriously. I had fun writing it and I hope you had fun too reading it. The SQL code is <a href="https://gist.github.com/crisbal/f072ecb8d43a8ecc58dda968e88417bb" target="_blank" rel="nofollow noopener noreferrer">available here</a>: use it wisely.</p>
</div></article></main><footer class="Footer View__footer"><a href="mailto:cristian@baldi.me" class="Footer__link">cristian@baldi.me</a></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"id":"6b774bce20f018f67cc213720ca4739a","title":"Emoji in SQL - SELECT ğŸ—£ FROM ğŸ‘¤","prettyDate":"26 June 2017","date":"2017-06-26","path":"\u002Fposts\u002F2017\u002F06\u002F26\u002Femoji-in-sql-select-from\u002F","content":"\u003Cscript src=\"\u002F\u002Ftwemoji.maxcdn.com\u002F2\u002Ftwemoji.min.js?2.3.0\"\u003E\u003C\u002Fscript\u003E\n\u003Cscript\u003E\nwindow.onload = function() {\n  twemoji.size = '72x72';\n  twemoji.parse(document.body);\n}\n\u003C\u002Fscript\u003E\n\u003Cstyle\u003E\nimg.emoji {\n\tmargin: 0px !important;\n\tdisplay: inline !important;\n\tbox-shadow: none !important;\n\theight: 1em !important;\n\twidth: 1em !important;\n\tmargin: 0 .05em 0 .1em !important;\n\tvertical-align: -0.1em !important;\n}\n.highlight .err {\n\tcolor: black !important;\n\tbackground-color: transparent !important;\n}\n\n\u003C\u002Fstyle\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003E\u003Cstrong\u003EWARNING\u003C\u002Fstrong\u003E Don't try this at \u003Cdel\u003Ehome\u003C\u002Fdel\u003E work: just because you can do it, it does not mean you should do it. Also don't take the post too seriously.\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EYesterday I had a doubt: can you use Emoji in SQL? No, I don't mean storing Emoji in a \u003Ccode\u003ETEXT\u003C\u002Fcode\u003E column, I mean using Emoji for naming databases, tables, columns. Turns out you can (at least on SQL implementations I tried, \u003Cstrong\u003ESQLite\u003C\u002Fstrong\u003E and \u003Cstrong\u003EPostgreSQL 9.6\u003C\u002Fstrong\u003E) and it works very well.\u003C\u002Fp\u003E\n\u003Cp\u003EIt is not magic, Emoji are Unicode characters and you can use Unicode characters inside SQL names.\u003C\u002Fp\u003E\n\u003Ch2 id=\"create-table-\"\u003E\u003Ca href=\"#create-table-\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECREATE TABLE ğŸ‘¤\u003C\u002Fh2\u003E\n\u003Cp\u003EI decided to re-implement the classic \"Public Library\" database we all built when learning SQL. Yes, \u003Cem\u003Ethat\u003C\u002Fem\u003E one database we have practiced on at school, storing users, books, authors and keeping tracks of Books read by users.\u003C\u002Fp\u003E\n\u003Cp\u003EFirst of all let's create the database, since we are working with a library we will call it ğŸ“š.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ECREATE DATABASE ğŸ“š;\nUSE ğŸ“š; -- \\c ğŸ“š in PostgreSQL\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThen we begin by creating the users table:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ECREATE TABLE ğŸ‘¤(\n    ğŸ”‘ INTEGER PRIMARY KEY,\n    ğŸ—£ varchar(64), -- name\n    ğŸ—“ DATE -- date of registration\n);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EAs you can see using Emoji solves the classical naming problem you have when programming: waste no more time on \"Should I call the table \u003Ccode\u003EUser\u003C\u002Fcode\u003E or \u003Ccode\u003EUsers\u003C\u002Fcode\u003E?\", just use ğŸ‘¤.\u003C\u002Fp\u003E\n\u003Cp\u003ELet's keep build the database by adding the table for the authors:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ECREATE TABLE âœ(\n    ğŸ”‘ INTEGER PRIMARY KEY,\n    ğŸ—£ varchar(64)\n);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EAnd a table for the books:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ECREATE TABLE ğŸ“•(\n    ğŸ”‘ INTEGER PRIMARY KEY,\n    ğŸ’¬ varchar(64), -- title\n    ğŸ”– varchar(64), -- genre\u002Ftag\n    âœ INTEGER REFERENCES âœ(ğŸ”‘) -- who wrote the book?\n);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EFinally let's create a table for storing which books were read by which user.\u003C\u002Fp\u003E\n\u003Cp\u003EWe will use the instantly recognizable name ğŸ‘¤ğŸ ğŸ“• for this table, which as we all know stands for \"User took the Book home\": it is that easy.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ECREATE TABLE ğŸ‘¤ğŸ ğŸ“•(\n    ğŸ‘¤ INTEGER REFERENCES ğŸ‘¤(ğŸ”‘),\n    ğŸ“• INTEGER REFERENCES ğŸ“•(ğŸ”‘)\n);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"populating-the-database\"\u003E\u003Ca href=\"#populating-the-database\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EPopulating the database\u003C\u002Fh2\u003E\n\u003Cp\u003EThis is the boring bit, just the classic \u003Ccode\u003EINSERT INTO\u003C\u002Fcode\u003Es.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003EINSERT INTO ğŸ‘¤ VALUES\n    (1, 'Jeff', CURRENT_DATE),\n    (2, 'Annie', CURRENT_DATE);\n\nINSERT INTO âœ VALUES\n    (1, 'Herman Melville'),\n    (2, 'Lewis Carroll');\n\nINSERT INTO ğŸ“• VALUES\n    (1, 'Alice in Wonderland', 'ğŸ”®', 2), -- genre is fantasy\n    (2, 'Moby Dick', 'ğŸ“–', 1), -- genre is novel\n    (3, 'Through the Looking-Glass', 'ğŸ”®', 2); -- genre is fantasy\n\nINSERT INTO ğŸ‘¤ğŸ ğŸ“• VALUES\n    (1, 1), -- Jeff took home 'Alice in Wonderland'\n    (1, 2), -- Jeff took home 'Moby Dick'\n    (2, 2); -- Annie took home 'Moby Dick'\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"queries\"\u003E\u003Ca href=\"#queries\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EQueries\u003C\u002Fh2\u003E\n\u003Cp\u003EOne common task when dealing with this database is finding out which books were read by which users. The query by itself is simple but using Emoji is even simpler: you visualize concepts not names.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003E-- get the book taken home by each people\nSELECT ğŸ‘¤.ğŸ—£ AS ğŸ‘¤, ğŸ“•.ğŸ’¬ AS ğŸ“•\nFROM ğŸ‘¤ JOIN ğŸ‘¤ğŸ ğŸ“• ON ğŸ‘¤.ğŸ”‘ = ğŸ‘¤ğŸ ğŸ“•.ğŸ‘¤\n    JOIN ğŸ“• ON ğŸ“•.ğŸ”‘ = ğŸ‘¤ğŸ ğŸ“•.ğŸ“•;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003Ewhich results in:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E   ğŸ‘¤  |         ğŸ“•\n-------+---------------------\n Jeff  | Alice in Wonderland\n Jeff  | Moby Dick\n Annie | Moby Dick\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"extending-the-concept\"\u003E\u003Ca href=\"#extending-the-concept\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EExtending the concept\u003C\u002Fh2\u003E\n\u003Cp\u003EWe want to extend our \u003Ccode\u003EğŸ“•\u003C\u002Fcode\u003E table to also store how long each book is. The naive solution would be to use an INTEGER field to solve the problem, but sometimes numbers are confusing, in these times Emoji are here to help.\u003C\u002Fp\u003E\n\u003Cp\u003ETo help us simplify the concept of book length we will use a custom \u003Ccode\u003ETYPE\u003C\u002Fcode\u003E (n.d.r: custom \u003Ccode\u003ETYPE\u003C\u002Fcode\u003Es are not available in SQLite).\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ECREATE TYPE ğŸ“„ AS ENUM ('ğŸ“„', 'ğŸ“„ğŸ“„', 'ğŸ“„ğŸ“„ğŸ“„', 'ğŸ“„ğŸ“„ğŸ“„ğŸ“„');\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThe longer the book the more ğŸ“„ it will have.\u003C\u002Fp\u003E\n\u003Cp\u003ELet's update the \u003Ccode\u003EğŸ“•\u003C\u002Fcode\u003E table.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003EALTER TABLE ğŸ“•\n    ADD COLUMN ğŸ”¢ğŸ“„ ğŸ“„ DEFAULT 'ğŸ“„';\n\nINSERT INTO ğŸ“• VALUES\n    (4, 'Example Book', 'ğŸ”®', 1, 'ğŸ“„ğŸ“„ğŸ“„');\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EIt is pretty easy to select long books (You may ask \"What is the definition of long?\", the answer is simple, more than 2 ğŸ“„):\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ESELECT * FROM ğŸ“• WHERE ğŸ“•.ğŸ”¢ğŸ“„ \u003E 'ğŸ“„ğŸ“„';\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EResulting in:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EğŸ”‘ |      ğŸ’¬       | ğŸ”– | âœ | ğŸ”¢ğŸ“„\n---+---------------+----+---+-------\n 4 | Example Book  | ğŸ“– | 1 | ğŸ“„ğŸ“„ğŸ“„\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"rating\"\u003E\u003Ca href=\"#rating\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ERating\u003C\u002Fh2\u003E\n\u003Cp\u003EWe also want the possibility for the users to rate books.\u003C\u002Fp\u003E\n\u003Cp\u003EIdeally we would want to implement a rating scale: for example a number from 1 to 10. But we all know that you can't really communicate how you feel about a book with just a number, that's why we need Emoji.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003ECREATE TYPE â­ AS ENUM ('ğŸ¤¢', 'â˜¹', 'ğŸ˜', 'ğŸ™‚', 'ğŸ˜');\n\nALTER TABLE ğŸ‘¤ğŸ ğŸ“•\n    ADD COLUMN â­ â­;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EWe then add some fake data:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003EINSERT INTO ğŸ‘¤ğŸ ğŸ“• VALUES\n    (1, 4, 'ğŸ˜'), -- Jeff took home 'Example Book' and rated it ğŸ˜\n    (2, 3, 'ğŸ™‚'), -- Annie took home 'Through the Looking-Glass' and rated it ğŸ™‚\n    (2, 4, 'ğŸ˜'), -- Annie took home 'Example Book' and rated it ğŸ˜\n    (2, 4, 'ğŸ¤¢'); -- Annie took home 'Example Book' (yes again) and rated it ğŸ¤¢\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EAnd we can finally get some meaningful info.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003E-- select the ratings for 'Example Book'\nSELECT ğŸ‘¤ğŸ ğŸ“•.â­\nFROM ğŸ‘¤ğŸ ğŸ“• JOIN ğŸ“• ON ğŸ‘¤ğŸ ğŸ“•.ğŸ“• = ğŸ“•.ğŸ”‘\nWHERE ğŸ“•.ğŸ’¬ = 'Example Book';\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cpre\u003E\u003Ccode\u003E â­\n---\n ğŸ˜\n ğŸ˜\n ğŸ¤¢\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThis next query is useful for the frontend, just display the Emoji instead of some over complicated visualization logic for the rating:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003E-- select the most common rating for each book\n-- MODE() is another function exclusive to PostgreSQL\n--- https:\u002F\u002Fwiki.postgresql.org\u002Fwiki\u002FAggregate_Mode\nSELECT ğŸ“•.ğŸ’¬, MODE() WITHIN GROUP (ORDER BY ğŸ‘¤ğŸ ğŸ“•.â­) AS MostCommonRating\nFROM ğŸ‘¤ğŸ ğŸ“• JOIN ğŸ“• ON ğŸ‘¤ğŸ ğŸ“•.ğŸ“• = ğŸ“•.ğŸ”‘\nGROUP BY  ğŸ“•.ğŸ”‘;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cpre\u003E\u003Ccode\u003E             ğŸ’¬            | mostcommonrating\n---------------------------+------------------\n Alice in Wonderland       | NULL\n Moby Dick                 | NULL\n Through the Looking-Glass | ğŸ™‚\n Example Book              | ğŸ˜\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"whats-next\"\u003E\u003Ca href=\"#whats-next\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWhat's next?\u003C\u002Fh2\u003E\n\u003Cp\u003EIt would be even cooler if we could write queries in this format, but I don't see this as a possibility without the cooperation from the major SQL DBMS.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-sql\"\u003EğŸ” *            -- SELECT *\nâ¡ï¸ ğŸ“•           -- FROM Book\nâ“ ğŸ“•.ğŸ’¬ = \"Moby Dick\"  -- WHERE Book.Title = \"Moby Dick\"\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EOn a serious note, I had the idea to write a comparator function that given two modified\u002Fcomposite Emoji (such as ğŸ…ğŸ¿ and ğŸ…ğŸ») would return TRUE if the two Emoji belong to the same unmodified Emoji: I did not want to waste much more time on this so I skipped it.\u003C\u002Fp\u003E\n\u003Cp\u003EI think it would be pretty trivial to do, since a modified\u002Fcomposite Emoji is just two Unicode characters one after another, so getting the first character from both Emoji and checking equality should be enough.\u003C\u002Fp\u003E\n\u003Cp\u003EIf someone implements this please let me know.\u003C\u002Fp\u003E\n\u003Ch2 id=\"summing-up\"\u003E\u003Ca href=\"#summing-up\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESumming up\u003C\u002Fh2\u003E\n\u003Cp\u003EPlease don't take this post seriously. I had fun writing it and I hope you had fun too reading it. The SQL code is \u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fcrisbal\u002Ff072ecb8d43a8ecc58dda968e88417bb\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eavailable here\u003C\u002Fa\u003E: use it wisely.\u003C\u002Fp\u003E\n","excerpt":"I had a doubt, can you use Emoji in SQL? Turns out you can, and it works very well."}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.9671136a.js" defer></script><script src="/assets/js/page--src--templates--post-vue.e9618719.js" defer></script>
  </body>
</html>
